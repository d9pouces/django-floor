Debian Installation
===================

By default, {{ FLOOR_PROJECT_NAME }} is only packaged as a standard Python project, downloadable from `Pypi <https://pypi.python.org>`_.
However, you can create pure Debian packages with `DjangoFloor <http://django-floor.readthedocs.org/en/latest/packaging.html#debian-ubuntu>`_.

The source code provides several Bash scripts:

    * `deb-debian-7-python3.sh`,
    * `deb-debian-8-python3.sh`,
    * `deb-ubuntu-14.04-15.10.sh`.

These scripts are designed to run on basic installation and are split in five steps:

    * update system and install missing packages,
    * create a virtualenv and install all dependencies,
    * package all dependencies,
    * package {{ FLOOR_PROJECT_NAME }},
    * install all packages and {{ FLOOR_PROJECT_NAME }}, prepare a simple configuration to test.

If everything is ok, you can copy all the .deb packages to your private mirror or to the destination server.
The configuration is set in `/etc/{{ PROJECT_NAME }}/settings.ini`.
By default, {{ FLOOR_PROJECT_NAME }} is installed with Apache 2.2 (or 2.4) and Supervisor.
You can switch to Nginx or Systemd by tweaking the right `stdeb-XXX.cfg` file.

{% block authentication %}After installation and configuration, do not forget to create a superuser:

.. code-block:: bash

    sudo -u {{ PROJECT_NAME }} {{ PROJECT_NAME }}-manage createsuperuser

Default configuration file is `{{ path_etc_debian }}/{{ PROJECT_NAME }}/settings.ini`.
If you need more complex settings, you can override default values (given in `djangofloor.defaults` and
`{{ PROJECT_NAME }}.defaults`) by creating a file named `{{ path_etc_debian }}/{{ PROJECT_NAME }}/settings.py`.

.. code-block:: bash

    sudo service {{ PROJECT_NAME }}-gunicorn start
{% if USE_CELERY %}    sudo service {{ PROJECT_NAME }}-celery start
{% endif %}
{% endblock %}

{% block backup %}
{% with DF_PATH_BIN=path_bin_debian DF_PATH_ETC=path_etc_debian %}{% include 'djangofloor/include/backup.rst_tpl' %}{% endwith %}
{% endblock %}
{% block monitoring %}
{% with DF_PATH_BIN=path_bin_debian DF_PATH_ETC=path_etc_debian %}{% include 'djangofloor/include/monitoring.rst_tpl' %}{% endwith %}
{% endblock %}
